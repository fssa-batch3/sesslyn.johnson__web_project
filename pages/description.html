<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Description Page</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lora:ital@1&family=Noto+Serif+SC:wght@200;300;400&family=Open+Sans:wght@300;400;500&family=Shalimar&family=Source+Sans+Pro:ital,wght@0,200;0,300;0,400;0,600;0,700;0,900;1,200;1,300;1,400;1,600;1,700;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../assets/css/description.css">
    <link rel="stylesheet" href="../assets/css/profile/header.css">
    <link rel="stylesheet" href="../assets/css/normalize.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700," rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />


</head>

<body>

    <div class="container">

    </div>
    <script>

        let product_crud = JSON.parse(localStorage.getItem("product_crud"));
        let added_products = JSON.parse(localStorage.getItem("added_products"));

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const product_id = urlParams.get('product_id');

        let unique_id = product_crud.find(e => e.product_uuid == product_id);

        console.log(unique_id)
        localStorage.setItem('product', JSON.stringify(unique_id.product_uuid));

        const div_left = document.createElement("div");
        div_left.setAttribute("class", "left_corner");
        console.log(div_left)

        //<span class="real_price"></span>
        const span_round = document.createElement("span");
        span_round.setAttribute("class", "round");
        div_left.append(span_round);

        //<img/>
        const img_product = document.createElement("img");
        img_product.setAttribute("alt", "heart_icon");
        img_product.setAttribute("class", "heart_icon");
        img_product.setAttribute("onclick", "wish(event)");
        img_product.setAttribute("data-id", unique_id.product_uuid);
        img_product.setAttribute("src", "../assets/images/home_page/heart_icon.jpg");
        span_round.append(img_product);

        //<img/>
        const img_details = document.createElement("img");
        img_details.setAttribute("alt", unique_id["product_name"] + " image");
        img_details.setAttribute("class", "description_img");
        img_details.setAttribute("src", unique_id["image_url"]);
        div_left.append(img_details);

        const div_middle = document.createElement("div");
        div_middle.setAttribute("class", "middle_contain");
        console.log(div_middle)

        const div_review = document.createElement("div");
        div_review.setAttribute("class", "review");
        div_middle.append(div_review);

        //<p class="price"></p>
        const p_paragraph = document.createElement("p");
        p_paragraph.setAttribute("class", "review_para");
        p_paragraph.innerHTML = "Reviews";
        div_review.append(p_paragraph);


        //<span class="real_price"></span>
        const span_review = document.createElement("span");
        span_review.setAttribute("class", "star_icon");
        div_review.append(span_review);

        for (let k = 0; k < 5; k++) {
            //<i></i>
            const i_star = document.createElement("i");
            i_star.setAttribute("class", "fa fa-star");
            span_review.append(i_star);
        }

        const div_head = document.createElement("div");
        div_middle.append(div_head);

        //<h2></h2>
        const h1_title = document.createElement("h1");
        h1_title.setAttribute("class", "product_name");
        h1_title.innerHTML = unique_id["product_name"];
        div_head.append(h1_title);

        const div_amount = document.createElement("div");
        div_amount.setAttribute("class", "amount");
        div_head.append(div_amount);

        const h3_price = document.createElement("h3");
        h3_price.innerHTML = "Price";
        div_amount.append(h3_price);

        //<p class="price"></p>
        const p_price = document.createElement("p");
        p_price.setAttribute("class", "price");
        div_amount.append(p_price);

        //<span class="real_price"></span>
        const span_price = document.createElement("span");
        span_price.setAttribute("class", "current-price");
        span_price.innerHTML = "Rs. " + unique_id["product_sell"];
        p_price.append(span_price);

        //<del></del>
        const del_price = document.createElement("del");
        del_price.innerHTML = "Rs. " + unique_id["product_real"];
        p_price.append(del_price);

        //  <small> </small>
        const small_pattern = document.createElement("small");
        small_pattern.setAttribute("class", "actual-prize");
        small_pattern.innerHTML = unique_id["product_discount"] + "% off";
        p_price.append(small_pattern);

        const div_description = document.createElement("div");
        div_description.setAttribute("class", "product_description");
        div_head.append(div_description);

        const h3_head = document.createElement("h3");
        h3_head.setAttribute("class", "description_heading");
        h3_head.innerHTML = "Description :";
        div_description.append(h3_head);

        //<p class="price"></p>
        const p_text = document.createElement("p");
        p_text.innerHTML = unique_id["product_description"];
        div_description.append(p_text);

        const h3_warranty = document.createElement("h3");
        h3_warranty.setAttribute("class", "warranty");
        h3_warranty.innerHTML = "Warranty :";
        div_description.append(h3_warranty);

        //<p class="price"></p>
        const p_warrant = document.createElement("p");
        p_warrant.innerHTML = unique_id["product_warranty"];
        div_description.append(p_warrant);

        //<button class="btn"></button>
        const button_primary = document.createElement("button");
        button_primary.setAttribute("class", "btn_cart");
        button_primary.setAttribute("type", "submit");
        button_primary.setAttribute("data-id", unique_id["product_uuid"])
        button_primary.innerHTML = "Add to Cart";
        div_head.append(button_primary);

        //<img/>
        const img_cart = document.createElement("img");
        img_cart.setAttribute("alt", "cart_icon");
        img_cart.setAttribute("src", "../assets/images/home_page/cart.png");
        button_primary.append(img_cart);

        //<button class="btn"></button>
        const button_secondary = document.createElement("button");
        button_secondary.setAttribute("class", "btn-secondary");
        button_secondary.setAttribute("type", "submit");
        button_secondary.setAttribute("data-id", unique_id["product_uuid"])
        button_secondary.innerHTML = "Buy Now";
        div_head.append(button_secondary);

        const div_right = document.createElement("div");
        div_right.setAttribute("class", "right_corner");
        console.log(div_right)

        const parentDiv = document.createElement('div');
        div_right.append(parentDiv);

        const childDiv1 = document.createElement('div');
        const image1 = document.createElement('img');
        image1.src = '../assets/images/Chandelier/chandelier_3.jpg';
        image1.alt = 'chandelier image';
        image1.className = 'similar_product';
        parentDiv.append(image1);

        const header1 = document.createElement('h4');
        header1.className = 'header_similar';
        header1.textContent = 'Foder pendant chandelier';
        parentDiv.append(header1);

        const price1 = document.createElement('p');
        price1.className = 'price';
        price1.textContent = 'â‚¹ 10999';
        parentDiv.append(price1);

        const parentTop = document.createElement('div');
        parentTop.className = 'top';
        parentDiv.append(parentTop);

        const reviewIcon1 = document.createElement('span');
        reviewIcon1.className = 'review_icon';
        parentTop.append(reviewIcon1);

        for (let i = 0; i < 5; i++) {
            //<i></i>
            const star1 = document.createElement("i");
            star1.setAttribute("class", "fa fa-star");
            reviewIcon1.append(star1);
        }

        const round1 = document.createElement('span');
        round1.id = 'round';
        parentTop.append(round1);

        const image2 = document.createElement('img');
        image2.src = '../assets/images/home_page/heart_icon.jpg';
        image2.id = 'liked_icon';
        image2.alt = 'heart-icon';
        round1.append(image2);

        //2
        const parent2Div = document.createElement('div');
        div_right.append(parent2Div);

        const childDiv2 = document.createElement('div');
        const image3 = document.createElement('img');
        image3.src = '../assets/images/TV/tv units 7.jpeg';
        image3.alt = 'TV Units image';
        image3.className = 'similar_product';
        parent2Div.append(image3);

        const header2 = document.createElement('h4');
        header2.className = 'header_similar';
        header2.textContent = 'Wood shutter TV unit';
        parent2Div.append(header2);

        const price2 = document.createElement('p');
        price2.className = 'price';
        price2.textContent = 'â‚¹ 29999';
        parent2Div.append(price2);

        const parent2Top = document.createElement('div');
        parent2Top.className = 'top';
        parent2Div.append(parent2Top);

        const reviewIcon2 = document.createElement('span');
        reviewIcon2.className = 'review_icon';
        parent2Top.append(reviewIcon2);

        for (let i = 0; i < 5; i++) {
            //<i></i>
            const star2 = document.createElement("i");
            star2.setAttribute("class", "fa fa-star");
            reviewIcon2.append(star2);
        }

        const round2 = document.createElement('span');
        round2.id = 'round';
        parent2Top.append(round2);

        const image4 = document.createElement('img');
        image4.src = '../assets/images/home_page/heart_icon.jpg';
        image4.id = 'liked_icon';
        image4.alt = 'heart-icon';
        round2.append(image4);

        document.querySelector("div.container").append(div_left);
        document.querySelector("div.container").append(div_middle);
        document.querySelector("div.container").append(div_right);


        document.querySelector(".btn_cart").addEventListener("click", function () {

            let id_cart = this.dataset.id;
            let product_price = parseInt(document.querySelector(".current-price").innerHTML.replace("Rs.", "")); // Added parseInt() to convert product_price to a number
            let cart_list = JSON.parse(localStorage.getItem('cart_list')) || [];
            let product_name = document.querySelector(".product_name").innerHTML; // Removed unnecessary || [] here
            let image_url = document.querySelector(".description_img").getAttribute("src");
            let profile_id = JSON.parse(localStorage.getItem('profile_id'));
            let exist = cart_list.length &&
                JSON.parse(localStorage.getItem('cart_list')).some(data =>
                    data.product_uuid == id_cart && data.profile_id === profile_id
                );

            if (cart_list.find(p => p.product_uuid === id_cart && p.userId === profile_id)) {
                alert('Sorry, the product is already added to the cart');
                return;
            }
            if (!profile_id) {
                alert("Log In");
                window.location.href = "./profile/login.html";
                return;
            }
            if (!exist) {
                cart_list.push({
                    "product_uuid": id_cart,
                    "product_name": product_name,
                    "image_url": image_url,
                    "product_price": product_price,
                    "userId": profile_id,
                    "product_quantity": 1
                });
                localStorage.setItem('cart_list', JSON.stringify(cart_list));
                alert('Product Added to the Cart');
                location.href = "./cart.html";
            }
        });

        function wish(e) {
            e.preventDefault();
            let wish_list = JSON.parse(localStorage.getItem("wish_list")) || [];
            let profile_id = JSON.parse(localStorage.getItem("profile_id"));
            let condition = JSON.parse(localStorage.getItem("profile_id"))
            if (!condition) {
                alert("Log In")
                window.location.href = "./profile/login.html";
                return;
            }
            let product_uuid = new URLSearchParams(window.location.search).get('product_id');
            let prod_data = wish_list.find(product => product.product_id === product_uuid && product.user_id === profile_id);
            if (prod_data) {
                alert('Sorry, the product is already added to the wishlist');
                return;
            }
            else {
                let prod = {
                    product_id: product_uuid,
                    user_id: profile_id
                }
                wish_list.push(prod);
                localStorage.setItem("wish_list", JSON.stringify(wish_list));
                alert('Your product has been added to the wishlist')
                window.location.href = "./wishlist.html"
            }
        }

    </script>
    <script src="../assets/comments/header.js"></script>
</body>

</html>