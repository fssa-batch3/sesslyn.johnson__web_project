

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Cart</title>
    <link rel="stylesheet" href="../assets/css/cart-list.css">
    <link rel="stylesheet" href="../assets/css/normalize.css">
    <link rel="stylesheet" href="../assets/css/header and footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="dns-prefetch" href="//fonts.googleapis.com" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700," rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
</head>

<body>
  

    <div>

        <h2 class="heading"><span class="color">M</span>y Cart</h2>
    </div>

    <div class="content">
        <div class="container">
            <div class="cart-list">
               
            </div>
        </div>


        <div class="side-container">
            <div class="side-details">
                <h3>Total Amount</h3>
                <table>
                    <caption> </caption>
                    <tbody>
                        <tr>
                            <th></th>
                        </tr>


                        <tr class="table-row">
                            <td>Sub-total</td>
                            <td id="sub_total"></td>
                        </tr>

                        <tr>
                            <td>Delivery fee</td>
                            <td>free</td>
                        </tr>


                        <tr>
                            <td>TOTAL AMOUNT</td>
                            <td id="total_amount" ></td>
                        </tr>

                    </tbody>
                </table>

                <div class="placeorder">
                    <a href="./Checkout.html">
                        <button class="btn order-btn">Place order</button>
                    </a>
                </div>
            </div>
        </div>

    </div>

    <div class="footer">
        <div class="footer-div">
            <img class="footer-img" src="../assets/images/Main/casas-logo.png" alt="desktop image" />

            <div class="footer-media">
                <a href="https://www.facebook.com/profile.php?id=100087049213851"><img class="fb-icon"
                        src="../assets/images/Main/facebook-icon.png" alt="facebook-icon" /></a>
                <a href="https://github.com/Sesslyn041215"><img src="../assets/images/Main/github-new.png"
                        alt="github-icon" /></a>
                <a href="https://www.linkedin.com/in/sesslyn-j-989b18250"><img
                        src="../assets/images/Main/linked-icon.png" alt="linked-icon" /></a>
                <a href="https://twitter.com/SesslynJ"><img src="../assets/images/Main/twitter-icon.png"
                        alt="twitter-icon" /></a>
            </div>
        </div>

        <div class="footer-div">
            <h4>General</h4>
            <a href="../pages/Login/Register.html">
                <p>Sign Up</p>
            </a>
            <a href="../pages/queries.html">
                <p>About</p>
            </a>
            <a href="https://medium.com/@sesslyn2004">
                <p>Blog</p>
            </a>
            <a href="https://medium.com/@mohid-ahmed/ghow-to-stay-focused-when-working-from-home-b54c7ab39e96">
                <p>Careers</p>
            </a>
            <a
                href="https://medium.com/hackernoon/11-things-developers-love-hearing-from-non-developer-co-workers-ea94805cf05d">
                <p>Developers</p>
            </a>
        </div>

        <div class="footer-div">
            <h4>Browse Casas</h4>
            <a href="../index.html">
                <p>Main page</p>
            </a>
            <a href="../pages/Living room/project.html">
                <p>Chamber</p>
            </a>
            <a href="../pages/queries.html">
                <p>About</p>
            </a>
            <a href="../pages/Shop.html">
                <p>Shop</p>
            </a>
            <a href="../pages/liked.html">
                <p>Wishlist</p>
            </a>
            <a href="../pages/order.html">
                <p>Orders</p>
            </a>
        </div>

        <div class="footer-div">
            <h4>Business Solutions</h4>
            <a href="#">
                <p>Talent</p>
            </a>
            <a href="#">
                <p>Marketing</p>
            </a>
            <a href="#">
                <p>Sales</p>
            </a>
            <a href="#">
                <p>Learning</p>
            </a>
            <a href="#">
                <p>Creativity</p>
            </a>
        </div>
    </div>
    <script>

let product_crud = JSON.parse(localStorage.getItem("product_crud"));
        let cart_list = JSON.parse(localStorage.getItem("cart_list"));

        let cart_product = product_crud.filter(product =>
            cart_list.some(uuid => uuid.product_uuid === product.product_uuid)
        );
       
        let cart_product_list = JSON.parse(localStorage.getItem("cart_list"));

        let amount = 0;
      
        for (i = 0; i < cart_product.length; i++) {
            // Create the parent element with class "cart-details"
            const cartDetailsDiv = document.createElement("div");
            cartDetailsDiv.classList.add("cart-details");
        

            // Create the "remove" div
            const removeDiv = document.createElement("div");
            removeDiv.classList.add("remove");
            cartDetailsDiv.append(removeDiv);
         

            // Create the "i" element with class "fa-solid fa-xmark"
            const xMarkIcon = document.createElement("i");
            xMarkIcon.classList.add("fa-solid", "fa-xmark");
            xMarkIcon.setAttribute("data-remove",  cart_product[i]["product_uuid"]);
            xMarkIcon.setAttribute("id", "icon_remove");
            // xMarkIcon.setAttribute("class", "iconRemove");
            xMarkIcon.style.color = "rgb(238, 120, 120)";
            removeDiv.append(xMarkIcon);
            // console.log(xMarkIcon)

            // Create the "cart-img" div
            const cartImgDiv = document.createElement("div");
            cartImgDiv.classList.add("cart-img");
            cartDetailsDiv.append(cartImgDiv);
            // console.log(cartImgDiv)

            // Create the "a" element with href to "#"
            const productLink = document.createElement("a");
            productLink.href = "#";
            cartImgDiv.append(productLink);
            // console.log(productLink)

            // Create the "img" element with src equal to cart_product["image_url"]
            const productImg = document.createElement("img");
            productImg.src = cart_product[i]["image_url"];
            productImg.setAttribute("class", "img_product");
            productImg.setAttribute("alt", "cart-images");
            productLink.append(productImg);
            // console.log(productImg)

            // Create the "cart-list" div
            const cartListDiv = document.createElement("div");
            cartListDiv.classList.add("cart-list");
            cartDetailsDiv.append(cartListDiv);

            // Create the "description" div
            const descriptionDiv = document.createElement("div");
            descriptionDiv.classList.add("description");
            cartListDiv.append(descriptionDiv);

            // Create the "h4" element with class "product-head" and text equal to cart_product["product_name"]
            const productName = document.createElement("h4");
            productName.setAttribute("class", "product-head");
            productName.textContent = cart_product[i]["product_name"];
            descriptionDiv.append(productName);

            // Create the "p" element with class "product-company" and text "Minimal Furniture"
            const productCompany = document.createElement("p");
            productCompany.classList.add("product-company");
            const colorSpan = document.createElement("span");
            colorSpan.classList.add("color");
            colorSpan.textContent = "Minimal Furniture";
            productCompany.appendChild(colorSpan);
            descriptionDiv.append(colorSpan);

            // Create the "product-rate" div
            const productRateDiv = document.createElement("div");
            productRateDiv.classList.add("product-rate");
            cartListDiv.append(productRateDiv);

            let find_quantity = cart_list.find(e=> e.product_uuid  == cart_list[i]["product_uuid"]);
            console.log(find_quantity);

            // Create the "span" element with class "product-price" and text equal to cart_product["product_sell"]
            let productPrice = document.createElement("span");
            productPrice.classList.add("product-price");
            productPrice.textContent = "Rs." + cart_product[i]["product_sell"]*find_quantity["product_quantity"];
            productRateDiv.append(productPrice);

            // Create the "quant" div
            const quantDiv = document.createElement("div");
            quantDiv.classList.add("quant");
            cartListDiv.append(quantDiv);

            // Create the "label" element with text "Quantity"
            const quantityLabel = document.createElement("label");
            quantityLabel.textContent = "Quantity";
            quantDiv.append(quantityLabel);

           

            // Create the "input" element with class "quantity", type "number", value equal to find_quantity["product_quantity"], and id "cart_quantity"
            const quantityInput = document.createElement("input");
            quantityInput.classList.add("quantity");
            quantityInput.type = "number";
            quantityInput.value = find_quantity["product_quantity"];
            quantDiv.append(quantityInput);

            update = document.createElement("button");
            update.setAttribute("type", "button");
            update.setAttribute("class", "btn update");
            update.setAttribute("style", "display:none");
            update.innerText = "Update"
            quantDiv.append(update);

            //  <div class="product-description">
            const div_description = document.createElement("div");
            div_description.setAttribute("class", "buttons");
            cartListDiv.append(div_description);

            //<div></div>
            const div_descriptionButton = document.createElement("div");
            div_description.append(div_descriptionButton);

            // Create the "a" element with href to "#"
            const productTag = document.createElement("a");
            productTag.href = "#";
            div_descriptionButton.append(productTag);

            //<button class="btn"></button>
            const button_primary = document.createElement("button");
            button_primary.setAttribute("class", "btn");
            button_primary.setAttribute("id", "liked-product");
            button_primary.setAttribute("data-id", cart_product[i]["product_uuid"]);
            button_primary.innerHTML = "Move to Wishlist";
            productTag.append(button_primary);



            document.querySelector("div.cart-list").append(cartDetailsDiv);

            amount+= cart_list[i]["product_price"] * cart_list[i]["product_quantity"];

            console.log(amount);

        }

        document.getElementById("sub_total").innerText="Rs."+amount;
        document.getElementById("total_amount").innerText="Rs."+amount;
        
       // getting extra informatio like no.of.guest and date of delivery
       let updateBtn = document.querySelectorAll(".update")
        updateBtn.forEach(function (upDate) {
        upDate.addEventListener('click', function () {
      
                let parent = this.closest(".cart-details")
                console.log(parent)
   
                let getNumber = parent.querySelector(".quantity").value;
                let id = parent.querySelector("#icon_remove").getAttribute("data-remove");
                function getId(e) {
                    return e.product_uuid == id
                }
                findcartId = cart_list.filter(getId);
                console.log(findcartId)
                let y = findcartId[0]["product_price"]

                let up_totalcost = y * getNumber;
                console.log(up_totalcost);

                findcartId[0]["product_quantity"] = getNumber;
                localStorage.setItem("cart_list", JSON.stringify(cart_list));
                location.reload();
            })
        })
       
        // getting extra information like no.of.guest
        let number_of_guest = document.querySelectorAll(".quantity")
        number_of_guest.forEach(function (getGuest) {
            getGuest.addEventListener("click", function () {
                let parent = this.closest(".cart-details")
                update_btn = parent.querySelector(".update")
                update_btn.setAttribute("style", "display:block");
            })
        })


        let products = document.querySelectorAll("i#icon_remove")
               products.forEach(function(check){
                check.addEventListener("click", function (){
                    let product_id = this.dataset.remove;
                    localStorage.setItem("products_id", JSON.stringify(product_id));
                    console.log(product_id);
                  
                    if (confirm("Are you sure to remove this product?")){
                       let id = JSON.parse(localStorage.getItem("products_id"));
                        let all_products = JSON.parse(localStorage.getItem("cart_list"));
                        console.log(all_products);
                        let pdts = all_products.find(e => e.product_uuid == product_id)
                        console.log(pdts);
                        let indexOfProduct = all_products.indexOf(pdts);
                        all_products.splice(indexOfProduct, 1);
                        console.log(indexOfProduct);
                        localStorage.setItem("cart_list", JSON.stringify(all_products));
                    }
                     window.location.reload();
                });
            });

    </script>
      <script src="../../assets/comments/header.js"></script>
</body>

</html>

